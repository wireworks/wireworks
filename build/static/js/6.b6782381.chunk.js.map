{"version":3,"sources":["app/wireworks/networking/byte.ts","app/wireworks/utils/math.ts","app/wireworks/networking/layers/layer-3/address.ts","app/components/ErrorBox.tsx","app/components/FlowCanvas.tsx","app/wireworks/utils/canvas.ts","app/wireworks/networking/layers/layer-2/mac.ts","app/pages/tools/layer-2/macfetch.tsx"],"names":["ByteZero","Byte","ByteMax","ERROR_BYTE_RANGE","value","Object","_home_void_Documents_wireworks_github_io_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","bits","decimal","setDecimal","setBits","_home_void_Documents_wireworks_github_io_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","Math","floor","err","RangeError","name","arr","length","bit8","i","undefined","booleanArrayToBit8","decimalToBinary","binaryToDecimal","index","arguments","slice","clamp","min","max","binary","reversed","realIndex","pow","tmpDecimal","reverse","__webpack_require__","d","__webpack_exports__","Byte4Zero","cloneByte4","byte4","clone","ERROR_MASK_RANGE","ERROR_ADDRESS_PARSE","ERROR_NOT_NETWORK","joinBitIndex","byteIndex","bitIndex","splitBitIndex","byte4Index","Address","ip","mask","requireMask","requireNetwork","maskShort","parseAddress","setMaskShort","setMask","isNetworkAddress","Error","bytes","Array","minByte","maskByte","bit","maxByte","allowAbove30","compare","getNetworkAddress","getBroadcastAddress","other","j","ipBytes","maskBytes","net","getDecimal","subnets","secondIpBytes","_splitBitIndex","maskShortTmp","end","tmpMask","address","trim","match","exec","ipByte0","parseInt","ipByte1","ipByte2","ipByte3","setIp","matchIp","omitMask","shortMaskString","getMaskShort","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","ErrorBox","_ref","errorMessage","a","createElement","className","Node","pos","width","heigth","margins","image","connectorOffset","classCallCheck","visible","height","createClass","ctx","drawImage","x","y","w2","h2","b","c","side","p","getVertices","fw","fh","t","l","r","Label","text","textColor","backgroundColor","padding","borderRadius","font","textHeight","textAlign","lineDistance","getRealWidth","getRealHeight","fillStyle","w","h","beginPath","moveTo","arcTo","closePath","roundRect","fill","lines","split","line","spacer","measureText","fillText","biggest","Line","from","to","time","strokeStyle","strokeWidth","lineWidth","label","offX","offY","abs","getOutput","getInput","fromPoint","getStartPoint","toPoint","getEndPoint","currEnd","getCurrentEndPoint","lineCap","lineTo","stroke","draw","FlowCanvas","props","_this","possibleConstructorReturn","getPrototypeOf","call","drawables","canvas","lineIntervals","addDrawable","drawable","push","removeDrawable","indexOf","splice","clearDrawables","getDrawables","stopLineAnimations","clearInterval","connectNodes","speed","labelText","callback","prevTime","Date","now","scope","assertThisInitialized","interval","setInterval","deltaTime","startPoint","endPoint","distance","sqrt","fixedDeltaTime","connectMultipleNodes","connections","iterativeConnect","connection","getAlignedPoint","positionY","positionX","fromWidth","fromHeight","toWidth","toHeight","current","getContext","clearRect","React","createRef","react_default","ref","Component","ERROR_MAC_ADDRESS_PARSE","allowedChars","MAC","mac","asString","setBytes","str","toUpperCase","replace","piece","toString","computerImage","Image","routerImage","internetImage","switchImage","e","then","bind","res","src","default","speedValues","veryslow","slow","normal","fast","veryfast","grayWire","greenWire","yellowWire","MacFetch","txtTarget","selectOrigin","selectSpeed","macCanvas","state","origin","target","run","errStr","setState","ipFetch","error","console","_this2","htmlFor","id","defaultValue","type","onKeyDown","ev","placeholder","onClick","macfetch_MacFetchCanvas","MacFetchCanvas","_this3","flowCanvas","mSwitch","isSwitch","node","pcA","pcB","pcC","router","fixedLines","origins","A","B","C","fCanvas","drawIndex","lookingFor","nextHop","previous","path","_loop","targetStr","machine","response","resetCanvas","internetNode","internetLabel","pcALabel","pcBLabel","pcCLabel","routerLabel","onload"],"mappings":"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","file":"static/js/6.b6782381.chunk.js","sourcesContent":["import { decimalToBinary, binaryToDecimal } from \"../utils/math\";\n\n/**\n * An array of 8 bits (boolean values).\n */\nexport type Bit8 = [boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean];\n\n/**\n * Returns a Bit8 filled with false.\n */\nexport function Bit8Zero(): Bit8 {\n\treturn [false, false, false, false, false, false, false, false];\n}\n\n/**\n * Returns a Bit8 filled with true.\n */\nexport function Bit8Max(): Bit8 {\n\treturn [true, true, true, true, true, true, true, true];\n}\n\n/**\n * Returns a Byte corresponding to the number 0.\n */\nexport function ByteZero(): Byte {\n\treturn new Byte(Bit8Zero());\n}\n\n/**\n * Returns a Byte corresponding to the number 255.\n */\nexport function ByteMax(): Byte {\n\treturn new Byte(Bit8Max());\n}\n\nexport function booleanArrayToBit8 (arr: boolean[]): Bit8 {\n\tif (arr.length > 8) {\n\t\tthrow new RangeError(\"The boolean array must have a length of 8 or less\");\n\t}\n\tlet bit8: Bit8 = Bit8Zero();\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tbit8[i] = arr[i] !== undefined ? arr[i] : false;\n\t}\n\treturn bit8;\n}\n\n/**\n * Error name for a byte outside the correct range.\n */\nexport const ERROR_BYTE_RANGE = \"ByteRangeError\";\n\n/**\n * A Byte, composed of 8 bits (boolean values).\n * @author Henrique Colini\n */\nexport class Byte {\n\n\t/**\n\t * This Byte's Bit8 representation.\n\t */\t\n\tprivate bits: Bit8;\n\n\t/**\n\t * This Byte's numerical representation.\n\t */\n\tprivate decimal: number;\n\t\n\t/**\n\t * Constructs a Byte from a number (0-255) or a Bit8.\n\t * @constructor\n\t * @param  {number|Bit8} value The value of this Byte.\n\t */\n\n\tconstructor(value: number | Bit8) {\n\n\t\tif (typeof value === \"number\") {\n\t\t\tthis.setDecimal(value);\n\t\t}\n\t\telse {\n\t\t\tthis.setBits(value);\n\t\t}\n\n\t}\n\n\t/**\n\t * Sets the value of this Byte, using a number (0-255).\n\t * @param  {number} decimal\n\t */\n\n\tsetDecimal(decimal: number): void {\n\n\t\tif (decimal < 0 || decimal > 255 || decimal !== Math.floor(decimal)) {\n\t\t\tlet err = new RangeError(\"The decimal value of a byte must be an integer between 0-255 (inclusive)\");\n\t\t\terr.name = ERROR_BYTE_RANGE;\n\t\t\tthrow err;\n\t\t}\n\n\t\tthis.bits = booleanArrayToBit8(decimalToBinary(decimal));\n\t\tthis.decimal = decimal;\n\n\t}\n\n\t/**\n\t * Sets the value of this Byte, using a Bit8.\n\t * @param  {Bit8} bits\n\t */\n\n\tsetBits(bits: Bit8): void {\n\n\t\tthis.bits = bits;\n\t\tthis.decimal = binaryToDecimal(bits);\n\n\t}\n\n\t/**\n\t * Returns this Byte's numeric value.\n\t */\n\n\tgetDecimal(): number {\n\t\treturn this.decimal;\n\t}\n\n\t/**\n\t * Returns this Byte's Bit8 representation.\n\t */\n\n\tgetBits(): Bit8 {\n\t\treturn this.bits;\n\t}\n\n\t/**\n\t * Getter/Setter of a single bit from this Byte.\n\t * @param  {number} index The index of the bit.\n\t * @param  {boolean|undefined=undefined} value Optional. Sets the value for this bit.\n\t */\n\n\tbit(index: number, value: boolean | undefined = undefined): boolean {\n\n\t\tif (value !== undefined) {\n\t\t\tlet bits = this.bits;\n\t\t\tbits[index] = value;\n\t\t\tthis.setBits(bits);\n\t\t}\n\n\t\treturn this.bits[index];\n\n\t}\n\n\t/**\n\t * Clones this Byte.\n\t */\n\tclone(): Byte {\n\n\t\treturn new Byte(this.bits.slice() as Bit8)\n\n\t}\n\n}","/**\n * Returns a value, clamped between max and min.\n * @param  {number} value The number to be clamped.\n * @param  {number} min The minimum possible number.\n * @param  {number} max The maximum possible number.\n */\nexport function clamp(value: number, min: number, max: number): number {\n\treturn Math.min(Math.max(value, min), max);\n};\n\n/**\n * Converts a binary number (as a string, boolean array, or number array) to a decimal number.\n * @param  {boolean[]} binary The number to be converted. An array of booleans, read from left to right (e.g. 001 equals 4).\n * @param  {boolean} reversed Optional. Whether the input should be reversed (read from right to left). Defaults to false.\n */\nexport function binaryToDecimal(binary: boolean[], reversed: boolean = false): number {\n\n\tif (binary.length === 0) {\n\t\treturn 0;\n\t}\n\n\tlet decimal = 0;\n\n\tfor (let realIndex = 0; realIndex < binary.length; realIndex++) {\n\n\t\tlet i = reversed ? binary.length - realIndex - 1 : realIndex;\n\n\t\tdecimal += binary[i] ? Math.pow(2, i) : 0;\n\t\t\n\t}\n\n\treturn decimal;\n\t\n}\n\n/**\n * Converts a decimal number (must be a positive integer) to an array of booleans (read from left to right, such that 001 equals 4).\n * @param  {number} decimal The number to be converted. Must be a positive integer.\n * @param  {boolean} reversed Optional. Whether the output should be reversed (read from right to left). Defaults to false.\n */\nexport function decimalToBinary(decimal: number, reversed: boolean = false): boolean[] {\n\n\tif (decimal < 0) {\n\t\tthrow new RangeError(\"Attempting to convert negative number to binary\");\n\t}\n\n\tif (decimal !== Math.floor(decimal)) {\n\t\tthrow new RangeError(\"Attempting to convert non-integer number to binary\");\n\t}\n\n\tlet binary: boolean[] = [];\n\n\tlet tmpDecimal = decimal, i = 0;\n\n\twhile (tmpDecimal > 0) {\n\n\t\tbinary[i] = tmpDecimal % 2 ? true : false;\n\t\ttmpDecimal = Math.floor(tmpDecimal / 2);\n\n\t\ti++;\n\n\t}\n\n\tif (reversed) {\n\t\tbinary.reverse();\n\t}\n\n\treturn binary;\n\n}","import { Byte, ByteZero, ByteMax } from \"../../byte\";\n\n/**\n * An array of 4 Bytes.\n */\nexport type Byte4 = [Byte,Byte,Byte,Byte];\n\n/**\n * Returns a Byte4 corresponding to 0, 0, 0, 0.\n */\nexport function Byte4Zero(): Byte4 {\n\treturn [ByteZero(), ByteZero(), ByteZero(), ByteZero()];\n}\n\n/**\n * Returns a Byte4 corresponding to 255, 255, 255, 255.\n */\nexport function Byte4Max(): Byte4 {\n\treturn [ByteMax(), ByteMax(), ByteMax(), ByteMax()];\n}\n\n/**\n * Clones a Byte4.\n * @param  {Byte4} byte4 The Byte4 to be cloned.\n */\nexport function cloneByte4(byte4: Byte4): Byte4 {\n\n\tbyte4 = byte4.slice() as Byte4;\n\n\tfor (let i = 0; i < 4; i++) {\n\t\tbyte4[i] = byte4[i].clone();\t\t\n\t}\n\n\treturn byte4;\n\n}\n\n/**\n * Error name for a mask with holes.\n */\nexport const ERROR_MASK_HOLES = \"MaskHolesError\";\n/**\n * Error name for a mask outside the correct range.\n */\nexport const ERROR_MASK_RANGE = \"MaskRangeError\";\n/**\n * Error name for a malformated address string.\n */\nexport const ERROR_ADDRESS_PARSE = \"AddressParseError\";\n/**\n * Error name for a when an Address should be a Network Address, but isn't.\n */\nexport const ERROR_NOT_NETWORK = \"NotNetworkError\";\n\n/**\n * Converts a bit in Byte index to a bit in Byte4 index.\n * @param  {number} byteIndex The index of the Byte in a Byte4.\n * @param  {number} bitIndex The index of the bit in the Byte.\n */\nexport function joinBitIndex(byteIndex: number, bitIndex: number): number {\n\tif (byteIndex > 3 || byteIndex < 0) {\n\t\tthrow new RangeError(\"The byteIndex must be between 0-3 (inclusive)\");\n\t}\n\tif (bitIndex > 7 || bitIndex < 0) {\n\t\tthrow new RangeError(\"The bitIndex must be between 0-7 (inclusive)\");\n\t}\n\treturn (8 * byteIndex) + (7 - bitIndex);\n}\n\n/**\n * Converts a bit in Byte4 index to a bit in Byte index.\n * @param  {number} byte4Index The index of the bit in a Byte4.\n */\nexport function splitBitIndex(byte4Index: number): { byteIndex: number, bitIndex: number } {\n\tif (byte4Index > 31 || byte4Index < 0) {\n\t\tthrow new RangeError(\"The byte4Index must be between 0-31 (inclusive)\");\n\t}\n\treturn {\n\t\tbyteIndex: Math.floor(byte4Index / 8),\n\t\tbitIndex: 7 - (byte4Index % 8)\n\t};\n}\n\n/**\n * A full IP/Mask address.\n * @author Henrique Colini\n */\nexport class Address {\n\t\n\t/**\n\t * This Address' IP.\n\t */\n\tprivate ip: Byte4;\n\n\t/**\n\t * This Address' mask.\n\t */\n\tprivate mask: Byte4;\n\n\t/**\n\t * The numerical representation of this Address' mask.\n\t */\n\tprivate maskShort: number;\n\n\t\n\t/**\n\t * Constructs an Address, given an IP and a mask.\n\t * @constructor\n\t * @param  {Byte4|string} ip The IP of this Address. May be a Byte4 or a formatted string.\n\t * @param  {Byte4|number} mask Optional. The mask of this Address. May be a Byte4 or its numerical representation. If not given, defaults to /0.\n\t * @param  {boolean} requireMask Optional. If set to true, the mask becomes a required parameter in the formatted string.\n\t * @param  {boolean} requireNetwork Optional. If true, throws an error if this is not a Network Address. Defaults to false.\n\t */\n\tconstructor(ip: Byte4 | string, mask?: Byte4 | number, requireMask: boolean = false, requireNetwork: boolean = false) {\n\n\t\tif (typeof ip === \"string\") {\n\t\t\tthis.parseAddress(ip, requireMask);\n\t\t}\n\t\telse {\n\t\t\tthis.ip = ip;\n\t\t}\n\n\t\tif (!this.mask) {\n\t\t\tif (mask) {\n\t\t\t\tif (typeof mask === \"number\") {\n\t\t\t\t\tthis.setMaskShort(mask);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.setMask(mask);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.setMask(Byte4Zero());\n\t\t\t}\n\t\t}\n\n\t\tif (requireNetwork && !this.isNetworkAddress(true)) {\n\t\t\tlet err = new Error(\"Not a Network Address\");\n\t\t\terr.name = ERROR_NOT_NETWORK;\n\t\t\tthrow err;\n\t\t}\n\n\t}\n\n\t/**\n\t * Returns the Network Address of this Address.\n\t * @param {boolean} allowAbove30 Optional. If false, returns undefined if the mask is greater than 30. Defaults to false.\n\t */\n\tpublic getNetworkAddress(allowAbove30: boolean = false): Address {\n\n\t\tif (!allowAbove30 && this.maskShort > 30) return undefined;\n\n\t\tlet bytes: Byte4 = Array<Byte>(4) as Byte4;\n\n\t\tfor (let i = 0; i < 4; i++) {\n\n\t\t\tlet minByte = this.ip[i].clone();\n\t\t\tlet maskByte = this.mask[i];\n\n\t\t\tfor (let i = 0; i < 8; i++) {\n\t\t\t\tif (!maskByte.bit(i)) {\n\t\t\t\t\tminByte.bit(i, false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbytes[i] = minByte;\n\n\t\t}\n\n\t\treturn new Address(bytes, cloneByte4(this.mask));\n\n\t}\n\n\t/**\n\t * Returns the Broadcast Address of this Address' network.\n\t * @param {boolean} allowAbove30 Optional. If false, returns undefined if the mask is greater than 30. Defaults to false.\n\t */\n\tpublic getBroadcastAddress(allowAbove30: boolean = false): Address {\n\n\t\tif (!allowAbove30 && this.maskShort > 30) return undefined;\n\n\t\tlet bytes: Byte4 = Array<Byte>(4) as Byte4;\n\n\t\tfor (let i = 0; i < 4; i++) {\n\n\t\t\tlet maxByte = this.ip[i].clone();\n\t\t\tlet maskByte = this.mask[i];\n\n\t\t\tfor (let i = 0; i < 8; i++) {\n\t\t\t\tif (!maskByte.bit(i)) {\n\t\t\t\t\tmaxByte.bit(i, true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbytes[i] = maxByte;\n\n\t\t}\n\n\t\treturn new Address(bytes, cloneByte4(this.mask));\n\n\t}\n\t\n\t/**\n\t * Returns whether this Address is a Network Address.\n\t * @param {boolean} allowAbove30 Optional. If false, returns false if the mask is greater than 30. Defaults to false.\n\t */\n\tpublic isNetworkAddress(allowAbove30: boolean = false): boolean {\n\t\treturn this.compare(this.getNetworkAddress(allowAbove30));\n\t};\n\n\t/**\n\t * Returns whether this Address is a Broadcast Address.\n\t * @param {boolean} allowAbove30 Optional. If false, returns false if the mask is greater than 30. Defaults to false.\n\t */\n\tpublic isBroadcastAddress(allowAbove30: boolean = false): boolean {\n\t\treturn this.compare(this.getBroadcastAddress(allowAbove30));\n\t};\n\t\n\t/**\n\t * Returns true if this Address is the same as another.\n\t * @param {Address} other the Address to be compared with.\n\t */\n\tpublic compare(other: Address): boolean {\n\n\t\tif (!other) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this === other)\n\t\t\treturn true;\n\n\t\tif (this.ip === other.ip && (this.mask === other.mask || this.maskShort === other.maskShort))\n\t\t\treturn true;\n\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tfor (let j = 0; j < 8; j++) {\n\t\t\t\tif ((this.ip[i].bit(j) !== other.ip[i].bit(j)) || (this.mask[i].bit(j) !== other.mask[i].bit(j))) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\n\t\treturn true;\n\n\t}\n\t\n\t/**\n\t * Returns the amount of hosts that this Address' network has.\n\t * @param {boolean} requireNetwork Optional. If true, throws an error if this is not a Network Address. Defaults to false.\n\t */\n\tpublic numberOfHosts(requireNetwork: boolean = false): number {\n\n\t\tif(requireNetwork && !this.isNetworkAddress(true)) {\n\t\t\tlet err = new Error(\"Not a Network Address\");\n\t\t\terr.name = ERROR_NOT_NETWORK;\n\t\t\tthrow err;\n\t\t}\n\n\t\tif (this.maskShort === 31)\n\t\t\treturn 2;\n\t\tif (this.maskShort === 32)\n\t\t\treturn 1;\n\t\treturn (Math.pow(2, 32 - this.maskShort) - 2);\n\n\t}\n\n\t/**\n\t * Returns the first valid host Address of this network.\n\t * @param  {boolean} requireNetwork Optional. If true, throws an error if this is not a Network Address. Defaults to false.\n\t */\n\tpublic firstHost(requireNetwork: boolean = false): Address {\n\n\t\tif (requireNetwork && !this.isNetworkAddress(true)) {\n\t\t\tlet err = new Error(\"Not a Network Address\");\n\t\t\terr.name = ERROR_NOT_NETWORK;\n\t\t\tthrow err;\n\t\t}\n\n\t\tlet ipBytes: Byte4;\n\t\tlet maskBytes: Byte4;\n\n\t\tif (requireNetwork) {\n\t\t\tipBytes = cloneByte4(this.ip);\n\t\t\tmaskBytes = cloneByte4(this.mask);\n\t\t}\n\t\telse {\n\t\t\tlet net = this.getNetworkAddress(true);\n\t\t\tipBytes = net.ip;\n\t\t\tmaskBytes = net.mask;\n\t\t}\n\n\t\tif (this.maskShort < 31) {\n\t\t\tipBytes[3].setDecimal(ipBytes[3].getDecimal() + 1);\n\t\t}\n\n\t\treturn new Address(ipBytes, maskBytes);\n\n\t}\n\n\t/**\n\t * Returns the last valid host Address of this network.\n\t * @param  {boolean} requireNetwork Optional. If true, throws an error if this is not a Network Address. Defaults to false.\n\t */\n\tpublic lastHost(requireNetwork: boolean = false): Address {\n\n\t\tif (requireNetwork && !this.isNetworkAddress(true)) {\n\t\t\tlet err = new Error(\"Not a Network Address\");\n\t\t\terr.name = ERROR_NOT_NETWORK;\n\t\t\tthrow err;\n\t\t}\n\n\t\tlet ipBytes: Byte4;\n\t\tlet maskBytes: Byte4;\n\n\t\tlet net = this.getBroadcastAddress(true);\n\t\tipBytes = net.ip;\n\t\tmaskBytes = net.mask;\n\n\t\tif (this.maskShort < 31) {\n\t\t\tipBytes[3].setDecimal(ipBytes[3].getDecimal() - 1);\n\t\t}\n\n\t\treturn new Address(ipBytes, maskBytes);\n\n\t}\n\n\t/**\n\t * Divides this Address into two subnets.\n\t * @param  {boolean} requireNetwork Optional. If true, throws an error if this is not a Network Address. Defaults to false.\n\t */\n\tpublic subdivide(requireNetwork: boolean = false): [Address, Address] {\n\n\t\tif (requireNetwork && !this.isNetworkAddress(true)) {\n\t\t\tlet err = new Error(\"Not a Network Address\");\n\t\t\terr.name = ERROR_NOT_NETWORK;\n\t\t\tthrow err;\n\t\t}\n\n\t\tlet subnets: [Address, Address] = [undefined, undefined];\n\n\t\tif (this.maskShort === 32) {\n\t\t\treturn subnets;\n\t\t}\n\n\t\tlet ipBytes: Byte4;\n\n\t\tif (requireNetwork) {\n\t\t\tipBytes = cloneByte4(this.ip);\n\t\t}\n\t\telse {\n\t\t\tlet net = this.getNetworkAddress(true);\n\t\t\tipBytes = net.ip;\n\t\t}\n\n\t\tsubnets[0] = new Address(cloneByte4(ipBytes), this.maskShort+1);\n\t\t\n\t\tlet secondIpBytes: Byte4 = cloneByte4(ipBytes);\n\t\tlet {byteIndex, bitIndex} = splitBitIndex(this.maskShort);\n\t\tsecondIpBytes[byteIndex].bit(bitIndex, true);\n\n\t\tsubnets[1] = new Address(secondIpBytes, this.maskShort+1);\n\n\t\treturn subnets;\n\n\t}\n\t\n\t/**\n\t * Sets this Address' mask.\n\t * @param  {Byte4} mask The Byte4 mask to be set.\n\t */\n\tpublic setMask(mask: Byte4): void {\n\n\t\tlet maskShortTmp = 0;\n\t\tlet end = false;\n\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tfor (let j = 0; j < 8; j++) {\n\n\t\t\t\tif (mask[i].bit(8 - 1 - j)) {\n\t\t\t\t\tif(!end) {\n\t\t\t\t\t\tmaskShortTmp++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tlet err = new Error(\"Mask contains holes\");\n\t\t\t\t\t\terr.name = ERROR_MASK_HOLES;\n\t\t\t\t\t\tthrow err;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tend = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.maskShort = maskShortTmp;\n\t\tthis.mask = mask;\n\n\t}\n\n\t/**\n\t * Sets this Address' mask, given its numerical representation (0-32).\n\t * @param  {number} maskShort The numerical mask to be set.\n\t */\n\tpublic setMaskShort(maskShort: number): void {\n\n\t\tif (maskShort < 0 || maskShort > 32) {\n\t\t\tlet err = new RangeError(\"The short mask should be between 0 and 32\");\n\t\t\terr.name = ERROR_MASK_RANGE;\n\t\t\tthrow err;\n\t\t}\n\n\t\tlet tmpMask: Byte4 = Byte4Zero();\n\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tfor (let j = 0; j < 8; j++) {\n\t\t\t\tif (((8 * i) + j) < maskShort) {\n\t\t\t\t\ttmpMask[i].bit(8 - 1 - j, true);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttmpMask[i].bit(8 - 1 - j, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.maskShort = maskShort;\n\t\tthis.mask = tmpMask;\n\n\t}\n\n\t/**\n\t * Sets this Address' IP value.\n\t * @param  {Byte4} ip\n\t */\n\tpublic setIp(ip: Byte4): void {\n\t\tthis.ip = ip;\n\t}\n\n\t/**\n\t * Returns this Address' mask.\n\t */\n\tpublic getMask(): Byte4 {\n\t\treturn this.mask;\n\t}\n\n\t/**\n\t * Returns the numerical representation of this Address' mask.\n\t */\n\tpublic getMaskShort(): number {\n\t\treturn this.maskShort;\n\t}\n\t\n\t/**\n\t * Returns this Address' IP value.\n\t */\n\tpublic getIp(): Byte4 {\n\t\treturn this.ip;\n\t}\n\n\t/**\n\t * Sets this Address IP/Mask values from a parsed string.\n\t * @param  {string} address The full address, in the X.X.X.X/X format. If requireMask is false, the mask can be ommited and defaults to /0.\n\t * @param  {boolean=true} requireMask Whether the address requires the mask to be given.\n\t */\n\tpublic parseAddress(address: string, requireMask: boolean = true): void {\n\n\t\taddress = address.trim();\n\t\tconst fullRegex = /^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)\\/(\\d+)$/;\n\t\tconst ipRegex = /^(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)$/;\n\n\t\tlet match = fullRegex.exec(address);\n\n\t\tif (match !== null) {\n\t\t\tlet ipByte0 = new Byte(parseInt(match[1], 10));\n\t\t\tlet ipByte1 = new Byte(parseInt(match[2], 10));\n\t\t\tlet ipByte2 = new Byte(parseInt(match[3], 10));\n\t\t\tlet ipByte3 = new Byte(parseInt(match[4], 10));\n\t\t\tlet maskShort = parseInt(match[5], 10);\n\n\t\t\tif (maskShort < 0 || maskShort > 32) {\n\t\t\t\tlet err = new RangeError(\"The short mask should be between 0 and 32\");\n\t\t\t\terr.name = ERROR_MASK_RANGE;\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t\tthis.setIp([ipByte0, ipByte1, ipByte2, ipByte3]);\n\t\t\tthis.setMaskShort(maskShort);\n\t\t}\n\t\telse if (!requireMask) {\n\n\t\t\tlet matchIp = ipRegex.exec(address);\n\n\t\t\tif (matchIp !== null) {\n\t\t\t\tlet ipByte0 = new Byte(parseInt(matchIp[1], 10));\n\t\t\t\tlet ipByte1 = new Byte(parseInt(matchIp[2], 10));\n\t\t\t\tlet ipByte2 = new Byte(parseInt(matchIp[3], 10));\n\t\t\t\tlet ipByte3 = new Byte(parseInt(matchIp[4], 10));\n\n\t\t\t\tthis.setIp([ipByte0, ipByte1, ipByte2, ipByte3]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet err = new Error(\"Invalid IP/mask address string\");\n\t\t\t\terr.name = ERROR_ADDRESS_PARSE;\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\tlet err = new Error(\"Invalid IP/mask address string\");\n\t\t\terr.name = ERROR_ADDRESS_PARSE;\n\t\t\tthrow err;\n\t\t}\n\n\t}\n\n\t\n\t/**\n\t * Returns the string representation of this Address in the X.X.X.X/X format.\n\t * @param  {boolean} omitMask Whether the mask should be ommited. Defaults to false.\n\t */\n\ttoString(omitMask: boolean = false): string {\n\n\t\treturn \"\" +\n\t\t\tthis.ip[0].getDecimal() + \".\" +\n\t\t\tthis.ip[1].getDecimal() + \".\" +\n\t\t\tthis.ip[2].getDecimal() + \".\" +\n\t\t\tthis.ip[3].getDecimal() + (omitMask? \"\" : this.shortMaskString());\n\n\t}\n\n\t/**\n\t * Returns the string representation of the mask.\n\t */\n\tmaskString(): string {\n\t\treturn \"\" +\n\t\t\tthis.mask[0].getDecimal() + \".\" +\n\t\t\tthis.mask[1].getDecimal() + \".\" +\n\t\t\tthis.mask[2].getDecimal() + \".\" +\n\t\t\tthis.mask[3].getDecimal();\n\t}\n\n\tshortMaskString(): string {\n\t\treturn \"/\" + this.getMaskShort();\n\t}\n\n}","import React, { FC } from \"react\";\n\ninterface ErrorBoxProps {\n\terrorMessage: string\n}\n\nconst ErrorBox: FC<ErrorBoxProps> = ({errorMessage}) => {\n\n    if (errorMessage) {\n        return (\n            <div className=\"errorbox\">{errorMessage}</div>\n        );\n    }\n\n    return null;\n\n}\n\nexport default ErrorBox;","import React, { Component, RefObject } from \"react\";\nimport { clamp } from \"../wireworks/utils/math\";\nimport { roundRect } from \"../wireworks/utils/canvas\";\n\n/**\n * A 2D point.\n */\nexport type Point = { x: number, y: number }\n\n/**\n * Interface representing anything that can be drawn on the canvas.\n */\nexport interface Drawable {\n\n\tvisible: boolean;\n\tdraw(ctx: CanvasRenderingContext2D): void;\n\n}\n\n/**\n * A Drawable image that has special connecting points. Used to represent servers and clients in the canvas.\n */\nexport class Node implements Drawable {\n\t\n\tpublic visible = true;\n\tpublic pos: Point;\n\tpublic margins: { l: number, t: number, r: number, b: number };\n\tpublic width: number;\n\tpublic height: number;\n\tpublic image: HTMLImageElement;\n\tpublic connectorOffset: number;\n\n\tconstructor(pos: Point, width: number, heigth: number, margins: { l: number, t: number, r: number, b: number }, image: HTMLImageElement, connectorOffset: number = 0.25) {\n\t\tthis.pos = pos;\n\t\tthis.width = width;\n\t\tthis.height = heigth;\n\t\tthis.image = image;\n\t\tthis.margins = margins;\n\t\tthis.connectorOffset = connectorOffset;\n\t}\n\n\tpublic draw(ctx: CanvasRenderingContext2D): void {\n\t\t\n\t\tif (this.visible)\n\t\t\tctx.drawImage(this.image, this.pos.x - (this.width / 2), this.pos.y - (this.height / 2), this.width, this.height);\n\n\t}\n\n\t/**\n\t * Returns the 4 vertices of this rectangular Node. A, B, C and D represent the vertices clockwise, starting from the top left corner.\n\t */\n\tpublic getVertices(): {a: Point, b: Point, c: Point, d: Point} {\n\n\t\tlet x = this.pos.x;\n\t\tlet y = this.pos.y;\n\t\tlet w2 = this.width / 2;\n\t\tlet h2 = this.height / 2;\n\n\t\tlet a = { x: x - w2, y: y - h2 };\n\t\tlet b = { x: x + w2, y: y - h2 };\n\t\tlet c = { x: x + w2, y: y + h2 };\n\t\tlet d = { x: x - w2, y: y + h2 };\n\n\t\treturn {a,b,c,d};\n\n\t}\n\n\t/**\n\t * Returns an exit point of this Node, given the side.\n\t * @param side Which side to get the point from.\n\t */\n\tpublic getOutput(side: \"top\" | \"bottom\" | \"left\" | \"right\"): Point {\n\n\t\tlet p = this.getVertices();\n\t\tlet fw = this.connectorOffset * this.width;\n\t\tlet fh = this.connectorOffset * this.height;\n\n\t\tswitch (side) {\n\n\t\t\tcase \"top\":\n\t\t\t\treturn { x: p.a.x + fw, y: p.a.y - this.margins.t };\n\t\t\tcase \"bottom\":\n\t\t\t\treturn { x: p.c.x - fw, y: p.c.y + this.margins.b };\n\t\t\tcase \"left\":\n\t\t\t\treturn { x: p.d.x - this.margins.l, y: p.d.y - fh };\n\t\t\tcase \"right\":\n\t\t\t\treturn { x: p.c.x + this.margins.r, y: p.b.y + fh };\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Returns an entry point of this Node, given the side.\n\t * @param side Which side to get the point from.\n\t */\n\tpublic getInput(side: \"top\" | \"bottom\" | \"left\" | \"right\"): Point {\n\n\t\tlet p = this.getVertices();\n\t\tlet fw = this.connectorOffset * this.width;\n\t\tlet fh = this.connectorOffset * this.height;\n\n\t\tswitch (side) {\n\n\t\t\tcase \"top\":\n\t\t\t\treturn { x: p.b.x - fw, y: p.a.y - this.margins.t };\n\t\t\tcase \"bottom\":\n\t\t\t\treturn { x: p.d.x + fw, y: p.c.y + this.margins.b };\n\t\t\tcase \"left\":\n\t\t\t\treturn { x: p.d.x - this.margins.l, y: p.a.y + fh };\n\t\t\tcase \"right\":\n\t\t\t\treturn { x: p.c.x + this.margins.r, y: p.c.y - fh };\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * A Drawable text box.\n */\nexport class Label implements Drawable {\n\t\n\tpublic visible = true;\n\tpublic pos: Point;\n\tpublic text: string;\n\tpublic textColor: string;\n\tpublic backgroundColor: string;\n\tpublic padding: number;\n\tpublic borderRadius: number;\n\tpublic font: string;\n\tpublic textHeight: number;\n\tpublic lineDistance: number;\n\tpublic textAlign: \"left\"|\"center\"|\"right\";\n\n\tconstructor(pos: Point, text: string, textColor: string, backgroundColor: string, padding: number, borderRadius: number, font: string, textHeight: number, textAlign:\"left\"|\"center\"|\"right\" = \"left\", lineDistance: number = 3) {\n\t\tthis.pos = pos;\n\t\tthis.text = text;\n\t\tthis.textColor = textColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.padding = padding;\n\t\tthis.borderRadius = borderRadius;\n\t\tthis.font = font;\n\t\tthis.textHeight = textHeight;\n\t\tthis.lineDistance = lineDistance;\n\t\tthis.textAlign = textAlign;\n\t}\n\n\tpublic draw(ctx: CanvasRenderingContext2D): void {\n\t\t\n\t\tif (this.visible) {\n\t\t\tlet width = this.getRealWidth(ctx);\n\t\t\tlet height = this.getRealHeight();\n\n\t\t\tctx.fillStyle = this.backgroundColor;\n\t\t\troundRect(ctx, this.pos.x - (width / 2), this.pos.y - (height / 2), width, height, this.borderRadius).fill();\n\n\t\t\tctx.fillStyle = this.textColor;\n\t\t\tctx.font = this.font;\n\n\t\t\tlet lines = this.text.split(\"\\n\");\n\t\t\t\n\t\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\t\tconst line = lines[i];\n\t\t\t\tconst lineWidth = ctx.measureText(line).width + (2*this.padding);\n\t\t\t\tlet spacer = width-lineWidth;\n\n\t\t\t\tswitch (this.textAlign) {\n\t\t\t\t\tdefault:\n\t\t\t\t\tcase \"left\":\n\t\t\t\t\t\tspacer = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\tspacer /= 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tctx.fillText(line, this.pos.x + this.padding - (width / 2) + spacer, this.pos.y + this.padding + ((i+1)*this.textHeight) + ((i)*this.lineDistance) - (height / 2));\n\t\t\t}\n\t\t}\n\t}\t\n\t\n\t/**\n\t * Returns the width of this Label, considering the width of the text and the padding.\n\t */\n\tpublic getRealWidth(ctx: CanvasRenderingContext2D): number {\n\t\t\n\t\tlet biggest = 0;\n\t\tctx.font = this.font;\n\n\t\tlet lines = this.text.split('\\n');\n\t\t\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tlet w = ctx.measureText(line).width + (2*this.padding);\n\t\t\tif (w > biggest) biggest = w;\n\t\t}\n\n\t\treturn biggest;\n\t}\n\n\t/**\n\t * Returns the height of this Label, considering the height of the text and the padding.\n\t */\n\tpublic getRealHeight(): number {\n\t\t// return this.textHeight + (2*this.padding);\n\t\tlet lines = this.text.split('\\n').length;\n\t\treturn (lines * this.textHeight) + ((lines-1) * this.lineDistance) + (2*this.padding);\n\t}\n\n}\n\n/**\n * A Drawable line that connects the outputs and inputs of Nodes.\n */\nexport class Line implements Drawable {\n\n\tpublic visible = true;\n\tpublic from: Node;\n\tpublic to: Node;\n\tpublic time: number;\n\tpublic strokeStyle: string;\n\tpublic lineWidth: number;\n\tpublic label: Label;\n\n\tconstructor(from: Node, to: Node, time: number, strokeStyle: string, strokeWidth: number) {\n\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t\tthis.time = time;\n\t\tthis.strokeStyle = strokeStyle;\n\t\tthis.lineWidth = strokeWidth;\n\n\t}\n\n\t/**\n\t * Returns the start point of this Line.\n\t */\n\tpublic getStartPoint(): Point {\n\n\t\tlet offX = this.from.pos.x - this.to.pos.x;\n\t\tlet offY = this.from.pos.y - this.to.pos.y;\n\n\t\tif (Math.abs(offX) > Math.abs(offY)) {\n\t\t\tif (offX > 0) {\n\t\t\t\treturn this.from.getOutput(\"left\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.from.getOutput(\"right\");\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (offY > 0) {\n\t\t\t\treturn this.from.getOutput(\"top\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.from.getOutput(\"bottom\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Returns the end point of this Line.\n\t */\n\tpublic getEndPoint(): Point {\n\n\t\tlet offX = this.from.pos.x - this.to.pos.x;\n\t\tlet offY = this.from.pos.y - this.to.pos.y;\n\n\t\tif (Math.abs(offX) > Math.abs(offY)) {\n\t\t\tif (offX > 0) {\n\t\t\t\treturn this.to.getInput(\"right\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.to.getInput(\"left\");\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (offY > 0) {\n\t\t\t\treturn this.to.getInput(\"bottom\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.to.getInput(\"top\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Returns the current end point of this Line in a point of time.\n\t * @param fromPoint The starting point.\n\t * @param toPoint The end point to be reached.\n\t */\n\tpublic getCurrentEndPoint(fromPoint = this.getStartPoint(), toPoint = this.getEndPoint()): Point {\n\t\treturn {x: fromPoint.x + (this.time * (toPoint.x - fromPoint.x)), y: fromPoint.y + (this.time * (toPoint.y - fromPoint.y))};\n\t}\n\n\tpublic draw(ctx: CanvasRenderingContext2D): void {\n\n\t\tif (this.visible){\n\n\t\t\tlet fromPoint = this.getStartPoint();\n\t\t\tlet currEnd = this.getCurrentEndPoint(fromPoint);\n\n\t\t\tctx.beginPath();\n\t\t\tctx.strokeStyle = this.strokeStyle;\n\t\t\tctx.lineWidth = this.lineWidth;\n\t\t\tctx.lineCap = \"round\";\n\n\t\t\tctx.moveTo(fromPoint.x, fromPoint.y);\n\t\t\tctx.lineTo(currEnd.x, currEnd.y);\n\t\t\tctx.stroke();\n\n\t\t\tif (this.label) {\t\t\t\t\t\t\t\t\n\t\t\t\tthis.label.pos = currEnd;\n\t\t\t\tthis.label.draw(ctx);\n\t\t\t}\n\t\t}\n\n\t}\n\n}\n\n/**\n * A helper data structure used to represent the connection between two Nodes when creating a line. \n */\nexport type NodeConnection = {\n\tfrom: Node, \n\tto: Node, \n\tstrokeStyle: string, \n\tlineWidth: number, \n\tspeed: number, \n\tlabelText: string | undefined \n};\n\nexport interface FlowCanvasProps {\n\twidth: number,\n\theight: number,\n\tfixedDeltaTime: number\n};\n\nclass FlowCanvas extends Component<FlowCanvasProps> {\n\n\t/**\n\t * The list of elements drawn to the canvas.\n\t */\n\tprivate drawables: Drawable[] = [];\n\n\t/**\n\t * The reference to the canvas.\n\t */\n\tprotected canvas: RefObject<HTMLCanvasElement>;\t\t\n\t\n\t/**\n\t * The intervals of each line being drawn.\n\t */\n\tprotected lineIntervals: NodeJS.Timeout[] = [];\n\n\t/**\n\t * Adds a drawable to this FlowCanvas.\n\t * @param drawable The drawable to be added.\n\t */\n\tpublic addDrawable = (drawable: Drawable) => {\n\t\tthis.drawables.push(drawable);\n\t}\n\n\t/**\n\t * Removes a drawable from this FlowCanvas.\n\t * @param drawable The drawable to be removed.\n\t */\n\tpublic removeDrawable = (drawable: Drawable): boolean => {\n\t\tlet index = this.drawables.indexOf(drawable);\t\t\n\t\tif (index < 0) return false;\n\t\tthis.drawables.splice(index, 1);\n\t\treturn true;\n\t}\n\n\t/**\n\t * Removes all drawables from this FlowCanvas.\n\t */\n\tpublic clearDrawables = () => {\n\t\tthis.drawables = [];\n\t}\n\n\t/**\n\t * Returns the list of drawables of this FlowCanvas.\n\t */\n\tpublic getDrawables = (): Drawable[] => {\n\t\treturn this.drawables;\n\t}\n\n\t/**\n\t * Stops all line animations.\n\t */\n\tpublic stopLineAnimations = () => {\n\t\tfor (let i = 0; i < this.lineIntervals.length; i++) {\n\t\t\tclearInterval(this.lineIntervals[i]);\n\t\t}\n\t}\n\n\t/**\n\t * Connects two Nodes with a Line, drawing it over time, given a speed. \n\t * @param from The Node to start the Line from.\n\t * @param to The Node to get the Line to.\n\t * @param strokeStyle The stroke style of the Line.\n\t * @param lineWidth The line width.\n\t * @param speed The speed of the Line being drawn, in pixels per second.\n\t * @param labelText The text of the Line's label.\n\t * @param callback A callback for when the Line finishes drawing.\n\t */\n\tpublic connectNodes = (from: Node, to: Node, strokeStyle: string, lineWidth: number, speed: number, labelText: string|undefined, callback: Function = undefined): Line => {\n\n\t\tlet line = new Line(from, to, 0, strokeStyle, lineWidth);\n\n\t\tif (labelText) {\n\t\t\tline.label = new Label({x:0,y:0}, labelText, \"#000000\", strokeStyle, 5, 10, \"12px Monserrat, sans-serif\", 10);\n\t\t}\n\t\tthis.addDrawable(line);\n\n\t\tlet prevTime = Date.now();\n\t\tlet scope: FlowCanvas = this;\n\n\t\tlet interval = setInterval(function(){\n\n\t\t\tlet deltaTime = Date.now() - prevTime;\n\t\t\tprevTime = Date.now();\n\n\t\t\tlet startPoint = line.getStartPoint();\n\t\t\tlet endPoint = line.getEndPoint();\n\n\t\t\tlet distance = Math.sqrt(\n\t\t\t\t((startPoint.x - endPoint.x)*(startPoint.x - endPoint.x)) + ((startPoint.y - endPoint.y)*(startPoint.y - endPoint.y))\n\t\t\t);\n\n\t\t\tline.time = clamp(line.time + ((deltaTime/1000) * (speed/distance)), 0, 1);\n\n\t\t\tscope.draw();\n\t\t\t\n\t\t\tif (line.time >= 1) {\n\n\t\t\t\tline.time = 1;\n\n\t\t\t\tline.label = undefined;\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\n\t\t\t\tclearInterval(interval);\n\t\t\t\t\n\t\t\t\tscope.draw();\n\t\t\t}\n\n\t\t}, this.props.fixedDeltaTime);\n\n\t\tthis.lineIntervals.push(interval);\n\n\t\treturn line;\n\n\t}\n\n\t/**\n\t * Connects multiple nodes, in succession.\n\t * @param connections The list of connections to be made.\n\t * @param callback What do to when the last line finishes being drawn.\n\t */\n\tpublic connectMultipleNodes = (connections: NodeConnection[], callback: Function = undefined) => {\n\n\t\tlet iterativeConnect = (index: number) => {\n\n\t\t\tif(index < connections.length){\n\t\t\t\tlet connection = connections[index];\n\t\t\t\tindex++;\n\t\t\t\t\t\t\n\t\t\t\tthis.connectNodes(connection.from, connection.to, connection.strokeStyle, connection.lineWidth, connection.speed, connection.labelText, function () {\n\t\t\t\t\titerativeConnect(index);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\titerativeConnect(0);\n\n\t}\n\n\t/**\n\t * Returns the position of a Node or Label when put aligned to another one.\n\t * @param from The Node or Label to be positioned relative to.\n\t * @param to The Node or Label to be positioned.\n\t * @param positionY How to align the Node or Label vertically. Can be \"top\", \"center\" or \"bottom\".\n\t * @param positionX How to align the Node or Label horizontally. Can be \"left\", \"center\" or \"right\".\n\t */\n\tpublic getAlignedPoint = (from: Node|Label, to: Node|Label, positionY: \"top\"|\"center\"|\"bottom\", positionX: \"left\"|\"center\"|\"right\"): Point => {\n\n\t\tlet offX: number;\t\n\t\tlet offY: number;\t\n\n\t\tswitch (positionX) {\n\t\t\tcase \"left\": offX = -0.5; break;\n\t\t\tcase \"center\": offX = 0; break;\n\t\t\tcase \"right\": offX = 0.5; break;\n\t\t}\n\n\t\tswitch (positionY) {\n\t\t\tcase \"top\": offY = -0.5; break;\n\t\t\tcase \"center\": offY = 0; break;\n\t\t\tcase \"bottom\": offY = 0.5; break;\n\t\t}\n\n\t\tlet fromWidth: number;\n\t\tlet fromHeight: number;\n\t\tlet toWidth: number;\n\t\tlet toHeight: number;\n\n\t\tif (from instanceof Node) {\n\t\t\tfromWidth = from.width;\t\t\n\t\t\tfromHeight = from.height;\t\t\n\t\t}\n\t\tif (to instanceof Node) {\n\t\t\ttoWidth = to.width;\t\t\n\t\t\ttoHeight = to.height;\t\t\n\t\t}\n\t\tif (from instanceof Label) {\n\t\t\tfromWidth = from.getRealWidth(this.canvas.current.getContext(\"2d\"));\t\t\n\t\t\tfromHeight = from.getRealHeight();\t\t\n\t\t}\n\t\tif (to instanceof Label) {\n\t\t\ttoWidth = to.getRealWidth(this.canvas.current.getContext(\"2d\"));\t\t\n\t\t\ttoHeight = to.getRealHeight();\t\t\n\t\t}\n\n\t\treturn {\n\t\t\tx: from.pos.x + (offX * (fromWidth + toWidth)),\n\t\t\ty: from.pos.y + (offY * (fromHeight + toHeight))\n\t\t};\n\n\t}\n\n\t/**\n\t* Renders all the Drawables to the canvas.\n\t*/\n\tpublic draw = () => {\n\n\t\tlet ctx = this.canvas.current.getContext(\"2d\");\n\n\t\tctx.clearRect(0, 0, this.props.width, this.props.height);\n\n\t\tif (this.drawables) {\n\t\t\tfor (let i = 0; i < this.drawables.length; i++) {\n\t\t\t\tthis.drawables[i].draw(ctx);\t\n\t\t\t}\n\t\t}\n\n\t}\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.canvas = React.createRef();\n\t}\t\n\n\tcomponentWillUnmount() {\n\t\tthis.stopLineAnimations();\n\t}\n\n\trender() {\n\t\treturn <canvas width={this.props.width} height={this.props.height} ref={this.canvas} className=\"flow-canvas\"></canvas>;\n\t}\n\n}\n\nexport default FlowCanvas;","/**\n * Draws a rounded rectangle in the canvas.\n * @param x The x coordinate of the rectangle.\n * @param y The y coordinate of the rectangle.\n * @param w The width of the rectangle.\n * @param h The height of the rectangle.\n * @param r The radius of the border.\n */\nexport function roundRect(ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number, r: number): CanvasRenderingContext2D {\n\tif (w < 2 * r) r = w / 2;\n\tif (h < 2 * r) r = h / 2;\n\tctx.beginPath();\n\tctx.moveTo(x + r, y);\n\tctx.arcTo(x + w, y, x + w, y + h, r);\n\tctx.arcTo(x + w, y + h, x, y + h, r);\n\tctx.arcTo(x, y + h, x, y, r);\n\tctx.arcTo(x, y, x + w, y, r);\n\tctx.closePath();\n\treturn ctx;\n}","import { Byte, ByteZero, ByteMax } from \"../../byte\";\n\n/**\n * An array of 6 Bytes.\n */\nexport type Byte6 = [Byte,Byte,Byte,Byte,Byte,Byte];\n\n/**\n * Returns a Byte6 corresponding to 0, 0, 0, 0, 0, 0.\n */\nexport function Byte6Zero(): Byte6 {\n\treturn [ByteZero(), ByteZero(), ByteZero(), ByteZero(), ByteZero(), ByteZero()];\n}\n\n/**\n * Returns a Byte6 corresponding to 255, 255, 255, 255, 255, 255.\n */\nexport function Byte6Max(): Byte6 {\n\treturn [ByteMax(), ByteMax(), ByteMax(), ByteMax(), ByteMax(), ByteMax()];\n}\n\n/**\n * Clones a Byte6.\n * @param  {Byte6} byte6 The Byte6 to be cloned.\n */\nexport function cloneByte6(byte6: Byte6): Byte6 {\n\n\tbyte6 = byte6.slice() as Byte6;\n\n\tfor (let i = 0; i < 6; i++) {\n\t\tbyte6[i] = byte6[i].clone();\t\t\n\t}\n\n\treturn byte6;\n\n}\n\n/**\n * Error name for a malformated MAC address string.\n */\nexport const ERROR_MAC_ADDRESS_PARSE = \"AddressParseError\";\n\nconst allowedChars = ['A','B','C','D','E','F','0','1','2','3','4','5','6','7','8','9'];\n\n/**\n * A MAC address.\n * @author Henrique Colini\n */\nexport default class MAC {\n\n\tprivate bytes: Byte6 = Byte6Zero();\n\tprivate asString: string;\n\t\n\t/**\n\t * Constructs a MAC address.\n\t * @param  {Byte6|string} mac The MAC address itself. May be a Byte6 or a formatted string.\n\t */\n\tconstructor(mac: Byte6|string) {\n\t\tif (typeof mac === \"string\") this.parseAddress(mac);\n\t\telse this.setBytes(mac);\n\t}\n\n\tpublic parseAddress(str: string) {\n\t\t\n\t\tstr = str.toUpperCase().replace(/[:.-]/g, \"\");\n\n\t\tif (str.length !== 12) {\n\t\t\tlet err = new Error(\"Invalid MAC address string\");\n\t\t\terr.name = ERROR_MAC_ADDRESS_PARSE;\n\t\t\tthrow err;\n\t\t}\n\t\t\n\t\tfor (let i = 0; i < str.length; i++) {\n\t\t\tconst c = str[i];\n\t\t\tif (allowedChars.indexOf(c) === -1) {\n\t\t\t\tlet err = new Error(\"Invalid MAC address string\");\n\t\t\t\terr.name = ERROR_MAC_ADDRESS_PARSE;\n\t\t\t\tthrow err;\n\t\t\t}\t\t\t\n\t\t}\n\n\t\tthis.asString = \"\";\n\t\t\n\t\tfor (let i = 0; i < 6; i++) {\n\t\t\tconst piece = str[i*2]+str[(i*2)+1];\n\t\t\tthis.bytes[i] = new Byte(parseInt(piece, 16));\n\t\t\tthis.asString += piece;\n\t\t\tif (i < 6-1) this.asString += \"-\";\n\t\t}\n\n\t}\n\n\t/**\n\t * Returns true if this MAC address is the same as another.\n\t * @param {MAC} other the MAC address to be compared with.\n\t */\n\tpublic compare(other: MAC): boolean {\n\n\t\tif (!other) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this === other)\n\t\t\treturn true;\n\n\t\tif (this.bytes === other.bytes)\n\t\t\treturn true;\n\n\t\tfor (let i = 0; i < 6; i++) {\n\t\t\tfor (let j = 0; j < 8; j++) {\n\t\t\t\tif (this.bytes[i].bit(j) !== other.bytes[i].bit(j)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tpublic setBytes(bytes: Byte6) {\n\t\tthis.bytes = bytes;\n\t\tthis.asString = \"\";\n\t\tfor (let i = 0; i < 6; i++) {\n\t\t\tlet piece = bytes[i].getDecimal().toString(16).toUpperCase();\n\t\t\tthis.asString += (piece.length<2? '0' : '') + piece;\n\t\t\tif (i < 6-1) this.asString += \"-\";\n\t\t}\n\t}\n\n\tpublic getBytes(): Byte6 {\n\t\treturn this.bytes;\n\t}\n\n\tpublic toString(): string {\n\t\treturn this.asString;\n\t}\n\n}","// MACFetch\n// +=========================+\n// Author: Henrique Colini\n// Version: 1.0 (2019-09-02)\n\nimport React, { Component, RefObject } from \"react\";\nimport FlowCanvas, { Node, Label, NodeConnection, Line } from \"../../../components/FlowCanvas\";\nimport { Address, ERROR_ADDRESS_PARSE, ERROR_MASK_RANGE } from \"../../../wireworks/networking/layers/layer-3/address\";\nimport ErrorBox from \"../../../components/ErrorBox\";\nimport { ERROR_BYTE_RANGE } from \"../../../wireworks/networking/byte\";\nimport MAC, { ERROR_MAC_ADDRESS_PARSE } from \"../../../wireworks/networking/layers/layer-2/mac\";\n\n// Images used in the canvas.\n\nconst computerImage = new Image();\nconst routerImage = new Image();\nconst internetImage = new Image();\nconst switchImage = new Image();\n\nimport(\"src/images/layers/2/computer.png\").then(res => computerImage.src = res.default);\nimport(\"src/images/layers/2/router.png\").then(res => routerImage.src = res.default);\nimport(\"src/images/layers/2/internet.png\").then(res => internetImage.src = res.default);\nimport(\"src/images/layers/2/switch.png\").then(res => switchImage.src = res.default);\n\n// Simulation speed constants.\n\ntype Speed = \"veryslow\" | \"slow\" | \"normal\" | \"fast\" | \"veryfast\";\n\nconst speedValues = {\n\tveryslow: 10,\n\tslow: 25,\n\tnormal: 50,\n\tfast: 200,\n\tveryfast: 600\n};\n\n// Wire colors.\n\nconst grayWire = \"#aaaaaa\";\nconst greenWire = \"#a9cc78\";\nconst yellowWire = \"#e5c16e\";\n\n/**\n * Helper data structure used to refer to MACFetch's computers and other network devices.\n */\ntype MACMachine = {\n\tip: Address,\n\tmac: MAC,\n\tnode: Node,\n\tconnections: MACMachine[],\n\tisSwitch: boolean\n};\n\n// +==============================================+\n\ninterface MacFetchProps {\n\tipFetch: boolean\n}\n\nclass MacFetch extends Component<MacFetchProps> {\n\n\t/** The reference to the target IP input. */\n\tprivate txtTarget: RefObject<HTMLInputElement>;\n\t/** The reference to the origin select. */\n\tprivate selectOrigin: RefObject<HTMLSelectElement>;\n\t/** The reference to the speed select. */\n\tprivate selectSpeed: RefObject<HTMLSelectElement>;\n\t/** The reference to the MacFetchCanvas. */\n\tprivate macCanvas: RefObject<MacFetchCanvas>;\n\t\n\tstate = {\n\t\terrorMessage: null as string,\n\t\torigin: undefined as \"A\"|\"B\"|\"C\",\n\t\ttarget: undefined as Address|MAC,\n\t\tspeed: undefined as Speed\n\t}\n\n\t/**\n\t * Runs the simulation.\n\t */\n\tpublic run = () => {\n\n\t\tlet errStr: string = null;\n\t\tthis.setState({errorMessage: null});\n\t\n\t\ttry {\n\t\t\t\n\t\t\tlet target: Address|MAC;\n\n\t\t\tif (this.props.ipFetch) {\n\t\t\t\ttarget = new MAC(this.txtTarget.current.value);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget = new Address(this.txtTarget.current.value, undefined, true);\n\t\t\t\t\n\t\t\t\tif (target.isNetworkAddress()) {\n\t\t\t\t\terrStr = \"Este é um endereço de rede. Escolha outro endereço.\";\n\t\t\t\t\tthrow Error;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\torigin: this.selectOrigin.current.value,\n\t\t\t\t\ttarget: target,\n\t\t\t\t\tspeed: this.selectSpeed.current.value\n\t\t\t\t},\n\t\t\t\tthis.macCanvas.current.run\n\t\t\t);\n\t\t\n\t\t} catch (error) {\n\t\t\t\n\t\t\tif(!errStr){\n\t\t\t\t\n\t\t\t\tswitch (error.name) {\n\t\t\t\t\tcase ERROR_MAC_ADDRESS_PARSE:\n\t\t\t\t\t\terrStr = \"O MAC do destino deve possuir o formato 00-00-00-00-00-00.\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ERROR_ADDRESS_PARSE:\n\t\t\t\t\t\terrStr = \"O IP do destino deve possuir o formato 0.0.0.0/0.\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ERROR_MASK_RANGE:\n\t\t\t\t\t\terrStr = \"O valor da máscara é alto demais (deve estar entre 0-32).\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ERROR_BYTE_RANGE:\n\t\t\t\t\t\terrStr = \"Um ou mais octetos possui um valor alto demais (deve estar entre 0-255).\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\terrStr = \"Erro desconhecido (\" + error.name + \").\";\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tthis.setState({errorMessage: \"Entrada inválida. \" + errStr})\n\t\n\t\t}\n\t}\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.txtTarget = React.createRef();\n\t\tthis.selectSpeed = React.createRef();\n\t\tthis.selectOrigin = React.createRef();\n\t\tthis.macCanvas = React.createRef();\n\t}\n\t\n\trender() {\n\t\treturn (\n\t\t\t<main>\n\t\t\t\t<div className=\"hbox align-end mb-3\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label htmlFor=\"origin\">Host de Origem</label>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<select id=\"origin\" ref={this.selectOrigin} defaultValue=\"A\">\n\t\t\t\t\t\t\t\t<option value=\"A\">Computador A</option>\n\t\t\t\t\t\t\t\t<option value=\"B\">Computador B</option>\n\t\t\t\t\t\t\t\t<option value=\"C\">Computador C</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label htmlFor=\"target_address\">{this.props.ipFetch? \"MAC\" : \"IP\"} de Destino</label>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<input type=\"text\" id=\"target_address\" ref={this.txtTarget} onKeyDown={(ev) => { if (ev.key === \"Enter\") this.run() }} placeholder={this.props.ipFetch ? \"00-00-00-00-00-00\" : \"0.0.0.1/0\"}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label htmlFor=\"speed\">Velocidade</label>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<select name=\"speed\" id=\"speed\" ref={this.selectSpeed} defaultValue=\"normal\">\n\t\t\t\t\t\t\t\t<option value=\"veryslow\">Muito Lento</option>\n\t\t\t\t\t\t\t\t<option value=\"slow\">Lento</option>\n\t\t\t\t\t\t\t\t<option value=\"normal\">Normal</option>\n\t\t\t\t\t\t\t\t<option value=\"fast\">Rápido</option>\n\t\t\t\t\t\t\t\t<option value=\"veryfast\">Muito Rápido</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<button onClick={this.run}>Visualizar</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ErrorBox errorMessage={this.state.errorMessage}/>\n\t\t\t\t<MacFetchCanvas ref={this.macCanvas} origin={this.state.origin} target={this.state.target} speed={this.state.speed} ipFetch={this.props.ipFetch}/>\n\t\t\t</main>\n\t\t);\n\t}\n\n}\n\nexport default MacFetch;\n\ninterface MacFetchCanvasProps {\n\torigin: \"A\"|\"B\"|\"C\",\n\ttarget: Address|MAC,\n\tspeed: Speed,\n\tipFetch: boolean\n}\n\n/**\n * The component representing MACFetch's FlowCanvas.\n */\nclass MacFetchCanvas extends Component<MacFetchCanvasProps> {\n\n\t/** The reference to the FlowCanvas. */\n\tprivate flowCanvas: RefObject<FlowCanvas>;\n\t\n\t// MACFetch's network devices and computers.\n\n\tprivate mSwitch: MACMachine = {ip: undefined, mac: undefined, connections: [], isSwitch: true, node: undefined};\n\tprivate pcA: MACMachine =     {ip: new Address(\"10.10.0.2/24\"), mac: new MAC(\"00-00-00-AA-AA-AA\"), connections: [this.mSwitch], isSwitch: false, node: undefined};\n\tprivate pcB: MACMachine =     {ip: new Address(\"10.10.0.3/24\"), mac: new MAC(\"00-00-00-BB-BB-BB\"), connections: [this.mSwitch], isSwitch: false, node: undefined};\n\tprivate pcC: MACMachine =     {ip: new Address(\"10.10.0.4/24\"), mac: new MAC(\"00-00-00-CC-CC-CC\"), connections: [this.mSwitch], isSwitch: false, node: undefined};\n\tprivate router: MACMachine =  {ip: new Address(\"10.10.0.1/24\"), mac: new MAC(\"00-00-00-F0-F0-F0\"), connections: [this.mSwitch], isSwitch: false, node: undefined};\n\t\n\t/** A list of fixed lines that shouldn't be removed upon simulation resetting. */\n\tprivate fixedLines: Line[] = [];\n\n\t/** An object mapping machines to simplified names. */\n\tprivate origins = {\n\t\tA: this.pcA,\n\t\tB: this.pcB,\n\t\tC: this.pcC\n\t}\n\n\t/**\n\t * Runs the simulation.\n\t */\n\tpublic run = () => {\n\n\t\tconst speed = speedValues[this.props.speed];\n\t\tconst fCanvas = this.flowCanvas.current;\n\t\tconst router = this.router;\n\t\tconst ipFetch = this.props.ipFetch;\n\n\t\tfCanvas.stopLineAnimations();\n\n\t\tconst drawables = fCanvas.getDrawables();\n\t\tlet drawIndex = drawables.length;\n\n\t\twhile(drawIndex--) {\n\t\t\tif(drawables[drawIndex] instanceof Line && this.fixedLines.indexOf(drawables[drawIndex] as Line) < 0) {\n\t\t\t\tfCanvas.removeDrawable(drawables[drawIndex]);\n\t\t\t}\n\t\t}\n\n\t\tlet lookingFor = this.props.target;\n\n\t\tconst response = function(path: MACMachine[]) {\n\t\t\t\n\t\t\tlet targetStr = (ipFetch? path[path.length-1].ip : path[path.length-1].mac).toString();\n\t\t\tlet connections: NodeConnection[] = [];\n\n\t\t\tfor (let i = path.length-1; i >= 1; i--) {\n\t\t\t\tconst machine = path[i];\n\n\t\t\t\tconnections.push({\n\t\t\t\t\tfrom: machine.node,\n\t\t\t\t\tto: path[i-1].node,\n\t\t\t\t\tstrokeStyle: greenWire,\n\t\t\t\t\tlineWidth: 5,\n\t\t\t\t\tspeed: speed,\n\t\t\t\t\tlabelText: targetStr\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\n\t\t\tfCanvas.connectMultipleNodes(connections);\n\n\t\t}\n\n\t\tconst nextHop = function (previous: MACMachine, from: MACMachine, path: MACMachine[]) {\n\t\t\n\t\t\tpath.push(from);\n\n\t\t\tfor (let i = 0; i < from.connections.length; i++) {\n\n\t\t\t\tconst to = from.connections[i];\n\t\n\t\t\t\tif (to !== previous) {\n\t\t\t\t\tlet line = fCanvas.connectNodes(\n\t\t\t\t\t\tfrom.node,\n\t\t\t\t\t\tto.node,\n\t\t\t\t\t\tyellowWire,\n\t\t\t\t\t\t5,\n\t\t\t\t\t\tspeed,\n\t\t\t\t\t\t(ipFetch ? \"IP de \" : \"MAC de \")+lookingFor.toString()+\"?\",\n\t\t\t\t\t\t() => { \n\t\t\t\t\t\t\tfCanvas.removeDrawable(line);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (to.connections.length > 1)\n\t\t\t\t\t\t\t\tnextHop(from, to, path);\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tif (!to.isSwitch) {\n\n\t\t\t\t\t\t\t\t\tlet comparison: boolean;\n\n\t\t\t\t\t\t\t\t\tif (ipFetch) comparison = to.mac.compare(lookingFor as MAC);\n\t\t\t\t\t\t\t\t\telse comparison = to.ip.compare(lookingFor as Address) || ((to === router) && !to.ip.getNetworkAddress().compare((lookingFor as Address).getNetworkAddress()));\n\n\t\t\t\t\t\t\t\t\tif (comparison) {\n\t\t\t\t\t\t\t\t\t\tpath.push(to);\n\t\t\t\t\t\t\t\t\t\tresponse(path);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\n\t\t}\n\n\t\tnextHop(undefined, this.origins[this.props.origin], []);\n\n\t}\n\n\t/**\n\t * Resets the canvas.\n\t */\n\tresetCanvas = () => {\n\n\t\tlet pl = 100; // padding\n\t\tlet pr = 100;\n\t\tlet pt = 50;\n\t\tlet pb = 90;\n\n\t\tconst fCanvas = this.flowCanvas.current;\n\n\t\tlet w = fCanvas.props.width;\n\t\tlet h = fCanvas.props.height;\n\t\t\n\t\tlet internetNode =  new Node({ x: pr,  y: pt },      60, 60, {l: 10, t: 10, r: 10, b: 10}, internetImage, 0.5);\n\t\tthis.router.node =  new Node({ x: w/2, y: pt },\t\t 60, 60, {l: 10, t: 10, r: 10, b: 10}, routerImage,   0.5);\n\t\tthis.pcB.node  =    new Node({ x: w/2, y: h - pb },  60, 60, {l: 10, t: 10, r: 10, b: 10}, computerImage, 0.5);\n\t\tthis.mSwitch.node = new Node({ x: w/2,  y: (this.pcB.node.pos.y + this.router.node.pos.y)/2 },  60, 30, {l: 10, t: 10, r: 10, b: 10}, switchImage,   0.5);\n\t\tthis.pcA.node  =    new Node({ x: pl,   y: (this.mSwitch.node.pos.y + this.pcB.node.pos.y)/2 }, 60, 60, {l: 10, t: 10, r: 10, b: 10}, computerImage, 0.5);\n\t\tthis.pcC.node  =    new Node({ x: w-pr, y: (this.mSwitch.node.pos.y + this.pcB.node.pos.y)/2 }, 60, 60, {l: 10, t: 10, r: 10, b: 10}, computerImage, 0.5);\n\n\t\tlet internetLabel = new Label({x: 0, y: 0}, \"Internet\",     \"#505050\", \"transparent\", 6, 0, \"14px Work Sans, Montserrat, sans-serif\", 12);\n\t\tinternetLabel.pos = fCanvas.getAlignedPoint(internetNode, internetLabel, \"bottom\", \"center\");\n\n\t\tlet pcALabel =    new Label({x: 0, y: 0}, \"Computador A\\n\" + this.pcA.ip.toString() + \"\\n\" + this.pcA.mac.toString(), \"#505050\", \"transparent\", 6, 0, \"14px Work Sans, Montserrat, sans-serif\", 12, \"center\");\n\t\tlet pcBLabel =    new Label({x: 0, y: 0}, \"Computador B\\n\" + this.pcB.ip.toString() + \"\\n\" + this.pcB.mac.toString(), \"#505050\", \"transparent\", 6, 0, \"14px Work Sans, Montserrat, sans-serif\", 12, \"center\");\n\t\tlet pcCLabel =    new Label({x: 0, y: 0}, \"Computador C\\n\" + this.pcC.ip.toString() + \"\\n\" + this.pcC.mac.toString(), \"#505050\", \"transparent\", 6, 0, \"14px Work Sans, Montserrat, sans-serif\", 12, \"center\");\n\t\tlet routerLabel = new Label({x: 0, y: 0}, \"Roteador\\n\" + this.router.ip.toString() + \"\\n\" + this.router.mac.toString(),     \"#505050\", \"transparent\", 6, 0, \"14px Work Sans, Montserrat, sans-serif\", 12);\n\n\t\tpcALabel.pos =    fCanvas.getAlignedPoint(this.pcA.node,    pcALabel,    \"bottom\", \"center\");\n\t\tpcBLabel.pos =    fCanvas.getAlignedPoint(this.pcB.node,    pcBLabel,    \"bottom\", \"center\");\n\t\tpcCLabel.pos =    fCanvas.getAlignedPoint(this.pcC.node,    pcCLabel,    \"bottom\", \"center\");\n\t\trouterLabel.pos = fCanvas.getAlignedPoint(this.router.node, routerLabel, \"center\", \"right\");\n\n\t\tthis.fixedLines = [\n\t\t\tnew Line(this.pcA.node, this.mSwitch.node, 1, grayWire, 10),\n\t\t\tnew Line(this.pcB.node, this.mSwitch.node, 1, grayWire, 10),\n\t\t\tnew Line(this.pcC.node, this.mSwitch.node, 1, grayWire, 10),\n\t\t\tnew Line(this.router.node, this.mSwitch.node, 1, grayWire, 10),\n\t\t\tnew Line(this.router.node, internetNode, 1, grayWire, 10)\n\t\t];\n\n\t\tfCanvas.clearDrawables();\n\n\t\tfCanvas.addDrawable(this.pcA.node);\n\t\tfCanvas.addDrawable(this.pcB.node);\n\t\tfCanvas.addDrawable(this.pcC.node);\n\t\tfCanvas.addDrawable(this.mSwitch.node);\n\t\tfCanvas.addDrawable(this.router.node);\n\t\tfCanvas.addDrawable(internetNode);\n\t\tfCanvas.addDrawable(pcALabel);\n\t\tfCanvas.addDrawable(pcBLabel);\n\t\tfCanvas.addDrawable(pcCLabel);\n\t\tfCanvas.addDrawable(routerLabel);\n\t\tfCanvas.addDrawable(internetLabel);\n\n\t\tfor (let i = 0; i < this.fixedLines.length; i++) {\n\t\t\tfCanvas.addDrawable(this.fixedLines[i]);\n\t\t}\n\n\t\tfCanvas.draw();\n\n\t}\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.flowCanvas = React.createRef();\n\t\tthis.mSwitch.connections = [this.pcA, this.pcB, this.pcC, this.router];\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.resetCanvas();\n\t\tcomputerImage.onload = this.flowCanvas.current.draw;\n\t\trouterImage.onload = this.flowCanvas.current.draw;\n\t\tswitchImage.onload = this.flowCanvas.current.draw;\n\t}\n\t\n\trender() {\n\t\treturn <FlowCanvas ref={this.flowCanvas} width={750} height={560} fixedDeltaTime={1000 / 60}/>;\n\t}\n}"],"sourceRoot":""}